<html><head><base href="https://websim-notes-app.example.com/%20le%20nom%20de%20mon%20application%20de%20notes%20est%20bknotes%20cecentr%C3%A9%20avec%20un%20beau%20design">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BKNotes - Beautiful Calendar Notes App</title>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#4A90E2">
<link rel="apple-touch-icon" href="icon-192x192.png">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #F0F4F8;
    color: #333;
  }
  .header {
    background-color: #4A90E2;
    color: white;
    padding: 20px;
    text-align: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  .header h1 {
    margin: 0;
    font-size: 32px;
    font-weight: 600;
    letter-spacing: 1px;
  }
  .logo {
    font-size: 48px;
    margin-bottom: 10px;
  }
  .nav-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 15px;
  }
  .nav-button {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 18px;
    font-weight: 300;
    transition: transform 0.2s;
  }
  .nav-button:hover {
    transform: scale(1.1);
  }
  #calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 10px;
    padding: 20px;
    max-width: 1000px;
    margin: 0 auto;
  }
  .day {
    background-color: white;
    border-radius: 10px;
    min-height: 120px;
    padding: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .day:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }
  .day-number {
    font-size: 16px;
    font-weight: 600;
    color: #4A90E2;
    margin-bottom: 10px;
  }
  .event {
    background-color: #4A90E2;
    color: white;
    padding: 5px 10px;
    margin-bottom: 5px;
    font-size: 14px;
    border-radius: 5px;
    cursor: pointer;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    transition: background-color 0.2s;
  }
  .event:hover {
    background-color: #3A7BC8;
  }
  #eventModal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
  }
  .modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 30px;
    border: none;
    width: 80%;
    max-width: 500px;
    border-radius: 15px;
    box-shadow: 0 5px 30px rgba(0,0,0,0.3);
  }
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.2s;
  }
  .close:hover,
  .close:focus {
    color: #4A90E2;
  }
  #eventTitle, #eventDescription, #eventDate, #eventTime {
    width: 100%;
    padding: 12px;
    margin-bottom: 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
    transition: border-color 0.2s;
  }
  #eventTitle:focus, #eventDescription:focus, #eventDate:focus, #eventTime:focus {
    border-color: #4A90E2;
    outline: none;
  }
  button {
    padding: 12px 24px;
    background-color: #4A90E2;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    margin-right: 10px;
    transition: background-color 0.2s;
  }
  button:hover {
    background-color: #3A7BC8;
  }
  #editButton {
    background-color: #FFA500;
  }
  #editButton:hover {
    background-color: #FF8C00;
  }
</style>
</head>
<body>
  <div class="header">
    <div class="logo">üìù</div>
    <h1>BKNotes</h1>
    <div class="nav-buttons">
      <button class="nav-button" id="prevMonth">&lt; Pr√©c√©dent</button>
      <span id="currentMonthYear"></span>
      <button class="nav-button" id="nextMonth">Suivant &gt;</button>
    </div>
  </div>

  <div id="calendar"></div>

  <div id="eventModal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>√âv√©nement</h2>
      <input type="text" id="eventTitle" placeholder="Titre de l'√©v√©nement" readonly>
      <textarea id="eventDescription" placeholder="Description de l'√©v√©nement" readonly></textarea>
      <input type="date" id="eventDate" readonly>
      <input type="time" id="eventTime" readonly>
      <button id="editButton">Modifier</button>
      <button id="saveEvent">Enregistrer</button>
    </div>
  </div>

  <script>
    const calendar = document.getElementById('calendar');
    const modal = document.getElementById('eventModal');
    const closeBtn = document.getElementsByClassName('close')[0];
    const saveEventBtn = document.getElementById('saveEvent');
    const editButton = document.getElementById('editButton');
    const eventTitle = document.getElementById('eventTitle');
    const eventDescription = document.getElementById('eventDescription');
    const eventDate = document.getElementById('eventDate');
    const eventTime = document.getElementById('eventTime');
    const currentMonthYearSpan = document.getElementById('currentMonthYear');
    const prevMonthBtn = document.getElementById('prevMonth');
    const nextMonthBtn = document.getElementById('nextMonth');

    let currentDate = new Date();
    let selectedDay = null;
    let selectedEvent = null;
    let events = JSON.parse(localStorage.getItem('events')) || {};
    let isEditMode = false;

    function renderCalendar() {
      calendar.innerHTML = '';
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      
      currentMonthYearSpan.textContent = new Date(year, month).toLocaleString('default', { month: 'long', year: 'numeric' });

      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const daysInMonth = lastDay.getDate();
      const startingDay = firstDay.getDay();

      for (let i = 0; i < startingDay; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.classList.add('day');
        calendar.appendChild(emptyDay);
      }

      for (let i = 1; i <= daysInMonth; i++) {
        const dayElement = document.createElement('div');
        dayElement.classList.add('day');
        dayElement.innerHTML = `<div class="day-number">${i}</div>`;
        
        const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
        if (events[dateKey]) {
          events[dateKey].forEach(event => {
            const eventElement = document.createElement('div');
            eventElement.classList.add('event');
            eventElement.textContent = event.title;
            eventElement.addEventListener('click', (e) => {
              e.stopPropagation();
              openModal(i, event);
            });
            dayElement.appendChild(eventElement);
          });
        }
        
        dayElement.addEventListener('click', () => openModal(i));
        calendar.appendChild(dayElement);
      }
    }

    function openModal(day, existingEvent = null) {
      selectedDay = day;
      selectedEvent = existingEvent;
      const dateKey = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
      
      if (existingEvent) {
        eventTitle.value = existingEvent.title;
        eventDescription.value = existingEvent.description;
        eventDate.value = dateKey;
        eventTime.value = existingEvent.time;
        editButton.style.display = 'inline-block';
        setReadOnly(true);
      } else {
        eventTitle.value = '';
        eventDescription.value = '';
        eventDate.value = dateKey;
        eventTime.value = '';
        editButton.style.display = 'none';
        setReadOnly(false);
      }
      
      modal.style.display = 'block';
    }

    function setReadOnly(readonly) {
      eventTitle.readOnly = readonly;
      eventDescription.readOnly = readonly;
      eventDate.readOnly = readonly;
      eventTime.readOnly = readonly;
      isEditMode = !readonly;
    }

    closeBtn.onclick = () => {
      modal.style.display = 'none';
      setReadOnly(true);
    }

    editButton.onclick = () => {
      setReadOnly(false);
    }

    saveEventBtn.onclick = () => {
      const dateKey = eventDate.value;
      const newEvent = {
        title: eventTitle.value,
        description: eventDescription.value,
        time: eventTime.value
      };

      if (!events[dateKey]) {
        events[dateKey] = [];
      }

      if (selectedEvent) {
        // Update existing event
        const index = events[dateKey].findIndex(e => e === selectedEvent);
        if (index !== -1) {
          events[dateKey][index] = newEvent;
        }
      } else {
        // Add new event
        events[dateKey].push(newEvent);
      }

      localStorage.setItem('events', JSON.stringify(events));
      modal.style.display = 'none';
      setReadOnly(true);
      renderCalendar();
    }

    prevMonthBtn.onclick = () => {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar();
    }

    nextMonthBtn.onclick = () => {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar();
    }

    renderCalendar();

    // Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then((registration) => {
            console.log('Service Worker enregistr√© avec succ√®s:', registration.scope);
          })
          .catch((error) => {
            console.log('√âchec de l\'enregistrement du Service Worker:', error);
          });
      });
    }
  </script>

  <script>
    // Cr√©ation dynamique du manifest.json
    const manifestContent = {
      "name": "BKNotes",
      "short_name": "BKNotes",
      "description": "Application de notes avec calendrier √©l√©gant",
      "start_url": "/index.html",
      "display": "standalone",
      "background_color": "#F0F4F8",
      "theme_color": "#4A90E2",
      "icons": [
        {
          "src": "icon-192x192.png",
          "sizes": "192x192",
          "type": "image/png"
        },
        {
          "src": "icon-512x512.png",
          "sizes": "512x512",
          "type": "image/png"
        }
      ]
    };

    const blob = new Blob([JSON.stringify(manifestContent, null, 2)], {type: 'application/json'});
    const manifestURL = URL.createObjectURL(blob);

    const linkElement = document.querySelector('link[rel="manifest"]');
    if (linkElement) {
      linkElement.href = manifestURL;
    }

    // Cr√©ation du Service Worker
    const serviceWorkerContent = `
      const CACHE_NAME = 'bknotes-v1';
      const urlsToCache = [
        '/',
        '/index.html',
        '/icon-192x192.png',
        '/icon-512x512.png'
      ];

      self.addEventListener('install', (event) => {
        event.waitUntil(
          caches.open(CACHE_NAME)
            .then((cache) => cache.addAll(urlsToCache))
        );
      });

      self.addEventListener('fetch', (event) => {
        event.respondWith(
          caches.match(event.request)
            .then((response) => response || fetch(event.request))
        );
      });
    `;

    const swBlob = new Blob([serviceWorkerContent], {type: 'text/javascript'});
    const swURL = URL.createObjectURL(swBlob);

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register(swURL)
        .then((registration) => {
          console.log('Service Worker enregistr√© avec succ√®s:', registration.scope);
        })
        .catch((error) => {
          console.log('√âchec de l\'enregistrement du Service Worker:', error);
        });
    }
  </script>
</body>
</html>
